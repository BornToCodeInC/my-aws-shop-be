{"version":3,"file":"src/functions/getProductList/handler.js","mappings":"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","sources":["webpack://product-service/external node-commonjs \"https\"","webpack://product-service/external node-commonjs \"util\"","webpack://product-service/./node_modules/@middy/core/index.js","webpack://product-service/./node_modules/@middy/http-json-body-parser/index.js","webpack://product-service/./node_modules/@middy/util/index.js","webpack://product-service/webpack/bootstrap","webpack://product-service/webpack/runtime/compat get default export","webpack://product-service/webpack/runtime/define property getters","webpack://product-service/webpack/runtime/hasOwnProperty shorthand","webpack://product-service/webpack/runtime/make namespace object","webpack://product-service/./src/libs/api-gateway.ts","webpack://product-service/./node_modules/@middy/http-cors/node_modules/@middy/util/index.js","webpack://product-service/./node_modules/@middy/http-cors/index.js","webpack://product-service/./src/libs/lambda.ts","webpack://product-service/./src/providers/ProductProvider.ts","webpack://product-service/./src/functions/getProductList/handler.ts"],"sourcesContent":["module.exports = require(\"https\");","module.exports = require(\"util\");","\"use strict\";\n\nconst middy = (baseHandler = () => {}, plugin) => {\n  var _plugin$beforePrefetc;\n\n  plugin === null || plugin === void 0 ? void 0 : (_plugin$beforePrefetc = plugin.beforePrefetch) === null || _plugin$beforePrefetc === void 0 ? void 0 : _plugin$beforePrefetc.call(plugin);\n  const beforeMiddlewares = [];\n  const afterMiddlewares = [];\n  const onErrorMiddlewares = [];\n\n  const instance = (event = {}, context = {}) => {\n    var _plugin$requestStart;\n\n    plugin === null || plugin === void 0 ? void 0 : (_plugin$requestStart = plugin.requestStart) === null || _plugin$requestStart === void 0 ? void 0 : _plugin$requestStart.call(plugin);\n    const request = {\n      event,\n      context,\n      response: undefined,\n      error: undefined,\n      internal: {}\n    };\n    return runRequest(request, [...beforeMiddlewares], baseHandler, [...afterMiddlewares], [...onErrorMiddlewares], plugin);\n  };\n\n  instance.use = middlewares => {\n    if (Array.isArray(middlewares)) {\n      for (const middleware of middlewares) {\n        instance.applyMiddleware(middleware);\n      }\n\n      return instance;\n    }\n\n    return instance.applyMiddleware(middlewares);\n  };\n\n  instance.applyMiddleware = middleware => {\n    const {\n      before,\n      after,\n      onError\n    } = middleware;\n\n    if (!before && !after && !onError) {\n      throw new Error('Middleware must be an object containing at least one key among \"before\", \"after\", \"onError\"');\n    }\n\n    if (before) instance.before(before);\n    if (after) instance.after(after);\n    if (onError) instance.onError(onError);\n    return instance;\n  }; // Inline Middlewares\n\n\n  instance.before = beforeMiddleware => {\n    beforeMiddlewares.push(beforeMiddleware);\n    return instance;\n  };\n\n  instance.after = afterMiddleware => {\n    afterMiddlewares.unshift(afterMiddleware);\n    return instance;\n  };\n\n  instance.onError = onErrorMiddleware => {\n    onErrorMiddlewares.push(onErrorMiddleware);\n    return instance;\n  };\n\n  instance.__middlewares = {\n    before: beforeMiddlewares,\n    after: afterMiddlewares,\n    onError: onErrorMiddlewares\n  };\n  return instance;\n};\n\nconst runRequest = async (request, beforeMiddlewares, baseHandler, afterMiddlewares, onErrorMiddlewares, plugin) => {\n  try {\n    await runMiddlewares(request, beforeMiddlewares, plugin); // Check if before stack hasn't exit early\n\n    if (request.response === undefined) {\n      var _plugin$beforeHandler, _plugin$afterHandler;\n\n      plugin === null || plugin === void 0 ? void 0 : (_plugin$beforeHandler = plugin.beforeHandler) === null || _plugin$beforeHandler === void 0 ? void 0 : _plugin$beforeHandler.call(plugin);\n      request.response = await baseHandler(request.event, request.context);\n      plugin === null || plugin === void 0 ? void 0 : (_plugin$afterHandler = plugin.afterHandler) === null || _plugin$afterHandler === void 0 ? void 0 : _plugin$afterHandler.call(plugin);\n      await runMiddlewares(request, afterMiddlewares, plugin);\n    }\n  } catch (e) {\n    // Reset response changes made by after stack before error thrown\n    request.response = undefined;\n    request.error = e;\n\n    try {\n      await runMiddlewares(request, onErrorMiddlewares, plugin);\n    } catch (e) {\n      // Save error that wasn't handled\n      e.originalError = request.error;\n      request.error = e;\n      throw request.error;\n    } // Catch if onError stack hasn't handled the error\n\n\n    if (request.response === undefined) throw request.error;\n  } finally {\n    var _plugin$requestEnd;\n\n    await (plugin === null || plugin === void 0 ? void 0 : (_plugin$requestEnd = plugin.requestEnd) === null || _plugin$requestEnd === void 0 ? void 0 : _plugin$requestEnd.call(plugin, request));\n  }\n\n  return request.response;\n};\n\nconst runMiddlewares = async (request, middlewares, plugin) => {\n  for (const nextMiddleware of middlewares) {\n    var _plugin$beforeMiddlew, _plugin$afterMiddlewa;\n\n    plugin === null || plugin === void 0 ? void 0 : (_plugin$beforeMiddlew = plugin.beforeMiddleware) === null || _plugin$beforeMiddlew === void 0 ? void 0 : _plugin$beforeMiddlew.call(plugin, nextMiddleware === null || nextMiddleware === void 0 ? void 0 : nextMiddleware.name);\n    const res = await (nextMiddleware === null || nextMiddleware === void 0 ? void 0 : nextMiddleware(request));\n    plugin === null || plugin === void 0 ? void 0 : (_plugin$afterMiddlewa = plugin.afterMiddleware) === null || _plugin$afterMiddlewa === void 0 ? void 0 : _plugin$afterMiddlewa.call(plugin, nextMiddleware === null || nextMiddleware === void 0 ? void 0 : nextMiddleware.name); // short circuit chaining and respond early\n\n    if (res !== undefined) {\n      request.response = res;\n      return;\n    }\n  }\n};\n\nmodule.exports = middy;\n","\"use strict\";\n\nconst mimePattern = /^application\\/(.+\\+)?json(;.*)?$/;\nconst defaults = {\n  reviver: undefined\n};\n\nconst httpJsonBodyParserMiddleware = (opts = {}) => {\n  const options = { ...defaults,\n    ...opts\n  };\n\n  const httpJsonBodyParserMiddlewareBefore = async request => {\n    var _headers$ContentType;\n\n    const {\n      headers,\n      body\n    } = request.event;\n    const contentTypeHeader = (_headers$ContentType = headers === null || headers === void 0 ? void 0 : headers['Content-Type']) !== null && _headers$ContentType !== void 0 ? _headers$ContentType : headers === null || headers === void 0 ? void 0 : headers['content-type'];\n\n    if (mimePattern.test(contentTypeHeader)) {\n      try {\n        const data = request.event.isBase64Encoded ? Buffer.from(body, 'base64').toString() : body;\n        request.event.rawBody = body;\n        request.event.body = JSON.parse(data, options.reviver);\n      } catch (err) {\n        const {\n          createError\n        } = require('@middy/util'); // UnprocessableEntity\n\n\n        throw createError(422, 'Content type defined as JSON but an invalid JSON was provided');\n      }\n    }\n  };\n\n  return {\n    before: httpJsonBodyParserMiddlewareBefore\n  };\n};\n\nmodule.exports = httpJsonBodyParserMiddleware;\n","\"use strict\";\n\nconst {\n  Agent\n} = require('https'); // const { NodeHttpHandler } = require('@aws-sdk/node-http-handler') // aws-sdk v3\n\n\nconst awsClientDefaultOptions = {\n  // AWS SDK v3\n  // Docs: https://docs.aws.amazon.com/sdk-for-javascript/v3/developer-guide/enforcing-tls.html\n\n  /* requestHandler: new NodeHttpHandler({\n    httpsAgent: new Agent(\n      {\n        secureProtocol: 'TLSv1_2_method'\n      }\n    )\n  }) */\n  // Docs: https://docs.aws.amazon.com/sdk-for-javascript/v2/developer-guide/enforcing-tls.html\n  httpOptions: {\n    agent: new Agent({\n      secureProtocol: 'TLSv1_2_method'\n    })\n  }\n};\n\nconst createPrefetchClient = options => {\n  const awsClientOptions = { ...awsClientDefaultOptions,\n    ...options.awsClientOptions\n  };\n  const client = new options.AwsClient(awsClientOptions); // AWS XRay\n\n  if (options.awsClientCapture) {\n    return options.awsClientCapture(client);\n  }\n\n  return client;\n};\n\nconst createClient = async (options, request) => {\n  let awsClientCredentials = {}; // Role Credentials\n\n  if (options.awsClientAssumeRole) {\n    if (!request) throw new Error('Request required when assuming role');\n    awsClientCredentials = await getInternal({\n      credentials: options.awsClientAssumeRole\n    }, request);\n  }\n\n  awsClientCredentials = { ...awsClientCredentials,\n    ...options.awsClientOptions\n  };\n  return createPrefetchClient({ ...options,\n    awsClientOptions: awsClientCredentials\n  });\n};\n\nconst canPrefetch = options => {\n  return !(options !== null && options !== void 0 && options.awsClientAssumeRole) && !(options !== null && options !== void 0 && options.disablePrefetch);\n}; // Internal Context\n\n\nconst getInternal = async (variables, request) => {\n  if (!variables || !request) return {};\n  let keys = [];\n  let values = [];\n\n  if (variables === true) {\n    keys = values = Object.keys(request.internal);\n  } else if (typeof variables === 'string') {\n    keys = values = [variables];\n  } else if (Array.isArray(variables)) {\n    keys = values = variables;\n  } else if (typeof variables === 'object') {\n    keys = Object.keys(variables);\n    values = Object.values(variables);\n  }\n\n  const promises = [];\n\n  for (const internalKey of values) {\n    var _valuePromise;\n\n    // 'internal.key.sub_value' -> { [key]: internal.key.sub_value }\n    const pathOptionKey = internalKey.split('.');\n    const rootOptionKey = pathOptionKey.shift();\n    let valuePromise = request.internal[rootOptionKey];\n\n    if (typeof ((_valuePromise = valuePromise) === null || _valuePromise === void 0 ? void 0 : _valuePromise.then) !== 'function') {\n      valuePromise = Promise.resolve(valuePromise);\n    }\n\n    promises.push(valuePromise.then(value => pathOptionKey.reduce((p, c) => p === null || p === void 0 ? void 0 : p[c], value)));\n  } // ensure promise has resolved by the time it's needed\n  // If one of the promises throws it will bubble up to @middy/core\n\n\n  values = await Promise.allSettled(promises);\n  const errors = values.filter(res => res.status === 'rejected').map(res => res.reason.message);\n  if (errors.length) throw new Error(JSON.stringify(errors));\n  return keys.reduce((obj, key, index) => ({ ...obj,\n    [sanitizeKey(key)]: values[index].value\n  }), {});\n};\n\nconst sanitizeKeyPrefixLeadingNumber = /^([0-9])/;\nconst sanitizeKeyRemoveDisallowedChar = /[^a-zA-Z0-9]+/g;\n\nconst sanitizeKey = key => {\n  return key.replace(sanitizeKeyPrefixLeadingNumber, '_$1').replace(sanitizeKeyRemoveDisallowedChar, '_');\n}; // fetch Cache\n\n\nconst cache = {}; // key: { value:{fetchKey:Promise}, expiry }\n\nconst processCache = (options, fetch = () => undefined, request) => {\n  const {\n    cacheExpiry,\n    cacheKey\n  } = options;\n\n  if (cacheExpiry) {\n    const cached = getCache(cacheKey);\n    const unexpired = cached && (cacheExpiry < 0 || cached.expiry > Date.now());\n\n    if (unexpired && cached.modified) {\n      const value = fetch(request, cached.value);\n      cache[cacheKey] = {\n        value: { ...cached.value,\n          ...value\n        },\n        expiry: cached.expiry\n      };\n      return cache[cacheKey];\n    }\n\n    if (unexpired) {\n      return { ...cached,\n        cache: true\n      };\n    }\n  }\n\n  const value = fetch(request);\n  const expiry = Date.now() + cacheExpiry;\n\n  if (cacheExpiry) {\n    cache[cacheKey] = {\n      value,\n      expiry\n    };\n  }\n\n  return {\n    value,\n    expiry\n  };\n};\n\nconst getCache = key => {\n  return cache[key];\n}; // Used to remove parts of a cache\n\n\nconst modifyCache = (cacheKey, value) => {\n  if (!cache[cacheKey]) return;\n  cache[cacheKey] = { ...cache[cacheKey],\n    value,\n    modified: true\n  };\n};\n\nconst clearCache = (keys = null) => {\n  var _keys;\n\n  keys = (_keys = keys) !== null && _keys !== void 0 ? _keys : Object.keys(cache);\n  if (!Array.isArray(keys)) keys = [keys];\n\n  for (const cacheKey of keys) {\n    cache[cacheKey] = undefined;\n  }\n};\n\nconst jsonSafeParse = (string, reviver) => {\n  if (typeof string !== 'string') return string;\n  const firstChar = string[0];\n  if (firstChar !== '{' && firstChar !== '[' && firstChar !== '\"') return string;\n\n  try {\n    return JSON.parse(string, reviver);\n  } catch (e) {}\n\n  return string;\n};\n\nconst normalizeHttpResponse = response => {\n  var _response$headers, _response;\n\n  // May require updating to catch other types\n  if (response === undefined) {\n    response = {};\n  } else if (Array.isArray(response) || typeof response !== 'object' || response === null) {\n    response = {\n      body: response\n    };\n  }\n\n  response.headers = (_response$headers = (_response = response) === null || _response === void 0 ? void 0 : _response.headers) !== null && _response$headers !== void 0 ? _response$headers : {};\n  return response;\n}; // smaller version of `http-errors`\n\n\nconst statuses = require('./codes.json');\n\nconst {\n  inherits\n} = require('util');\n\nconst createErrorRegexp = /[^a-zA-Z]/g;\n\nconst createError = (code, message, properties = {}) => {\n  const name = statuses[code].replace(createErrorRegexp, '');\n  const className = name.substr(-5) !== 'Error' ? name + 'Error' : name;\n\n  function HttpError(message) {\n    // create the error object\n    const msg = message !== null && message !== void 0 ? message : statuses[code];\n    const err = new Error(msg); // capture a stack trace to the construction point\n\n    Error.captureStackTrace(err, HttpError); // adjust the [[Prototype]]\n\n    Object.setPrototypeOf(err, HttpError.prototype); // redefine the error message\n\n    Object.defineProperty(err, 'message', {\n      enumerable: true,\n      configurable: true,\n      value: msg,\n      writable: true\n    }); // redefine the error name\n\n    Object.defineProperty(err, 'name', {\n      enumerable: false,\n      configurable: true,\n      value: className,\n      writable: true\n    });\n    return err;\n  }\n\n  inherits(HttpError, Error);\n  const desc = Object.getOwnPropertyDescriptor(HttpError, 'name');\n  desc.value = className;\n  Object.defineProperty(HttpError, 'name', desc);\n  Object.assign(HttpError.prototype, {\n    status: code,\n    statusCode: code,\n    expose: code < 500\n  }, properties);\n  return new HttpError(message);\n};\n\nmodule.exports = {\n  createPrefetchClient,\n  createClient,\n  canPrefetch,\n  getInternal,\n  sanitizeKey,\n  processCache,\n  getCache,\n  modifyCache,\n  clearCache,\n  jsonSafeParse,\n  normalizeHttpResponse,\n  createError\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import type { APIGatewayProxyEvent, APIGatewayProxyResult, Handler } from 'aws-lambda';\nimport type { FromSchema } from 'json-schema-to-ts';\n\ntype ValidatedAPIGatewayProxyEvent<S> = Omit<APIGatewayProxyEvent, 'body'> & { body: FromSchema<S> }\nexport type ValidatedEventAPIGatewayProxyEvent<S> = Handler<ValidatedAPIGatewayProxyEvent<S>, APIGatewayProxyResult>\n\nexport const formatJSONResponse = (response: Record<string, unknown> | any[], code = 200) => {\n  return {\n    statusCode: code,\n    body: JSON.stringify(response)\n  };\n};\n","var _response;\nimport { Agent } from 'https';\nexport const awsClientDefaultOptions = {\n    httpOptions: {\n        agent: new Agent({\n            keepAlive: true,\n            secureProtocol: 'TLSv1_2_method'\n        })\n    }\n};\nexport const createPrefetchClient = (options)=>{\n    const awsClientOptions = {\n        ...awsClientDefaultOptions,\n        ...options.awsClientOptions\n    };\n    const client = new options.AwsClient(awsClientOptions);\n    if (options.awsClientCapture && options.disablePrefetch) {\n        return options.awsClientCapture(client);\n    } else if (options.awsClientCapture) {\n        console.warn('Unable to apply X-Ray outside of handler invocation scope.');\n    }\n    return client;\n};\nexport const createClient = async (options, request)=>{\n    let awsClientCredentials = {};\n    if (options.awsClientAssumeRole) {\n        if (!request) {\n            throw new Error('Request required when assuming role');\n        }\n        awsClientCredentials = await getInternal({\n            credentials: options.awsClientAssumeRole\n        }, request);\n    }\n    awsClientCredentials = {\n        ...awsClientCredentials,\n        ...options.awsClientOptions\n    };\n    return createPrefetchClient({\n        ...options,\n        awsClientOptions: awsClientCredentials\n    });\n};\nexport const canPrefetch = (options = {})=>{\n    return !options.awsClientAssumeRole && !options.disablePrefetch;\n};\nexport const getInternal = async (variables, request)=>{\n    if (!variables || !request) return {};\n    let keys = [];\n    let values = [];\n    if (variables === true) {\n        keys = values = Object.keys(request.internal);\n    } else if (typeof variables === 'string') {\n        keys = values = [\n            variables\n        ];\n    } else if (Array.isArray(variables)) {\n        keys = values = variables;\n    } else if (typeof variables === 'object') {\n        keys = Object.keys(variables);\n        values = Object.values(variables);\n    }\n    const promises = [];\n    for (const internalKey of values){\n        const pathOptionKey = internalKey.split('.');\n        const rootOptionKey = pathOptionKey.shift();\n        let valuePromise = request.internal[rootOptionKey];\n        if (!isPromise(valuePromise)) {\n            valuePromise = Promise.resolve(valuePromise);\n        }\n        promises.push(valuePromise.then((value)=>pathOptionKey.reduce((p, c)=>p?.[c], value)));\n    }\n    values = await Promise.allSettled(promises);\n    const errors = values.filter((res)=>res.status === 'rejected').map((res)=>res.reason);\n    if (errors.length) {\n        const error = new Error('Failed to resolve internal values');\n        error.cause = errors;\n        throw error;\n    }\n    return keys.reduce((obj, key, index)=>({\n            ...obj,\n            [sanitizeKey(key)]: values[index].value\n        }), {});\n};\nconst isPromise = (promise)=>typeof promise?.then === 'function';\nconst sanitizeKeyPrefixLeadingNumber = /^([0-9])/;\nconst sanitizeKeyRemoveDisallowedChar = /[^a-zA-Z0-9]+/g;\nexport const sanitizeKey = (key)=>{\n    return key.replace(sanitizeKeyPrefixLeadingNumber, '_$1').replace(sanitizeKeyRemoveDisallowedChar, '_');\n};\nconst cache = {};\nexport const processCache = (options, fetch = ()=>undefined, request)=>{\n    const { cacheExpiry , cacheKey  } = options;\n    if (cacheExpiry) {\n        const cached = getCache(cacheKey);\n        const unexpired = cached.expiry && (cacheExpiry < 0 || cached.expiry > Date.now());\n        if (unexpired && cached.modified) {\n            const value = fetch(request, cached.value);\n            cache[cacheKey] = {\n                value: {\n                    ...cached.value,\n                    ...value\n                },\n                expiry: cached.expiry\n            };\n            return cache[cacheKey];\n        }\n        if (unexpired) {\n            return {\n                ...cached,\n                cache: true\n            };\n        }\n    }\n    const value1 = fetch(request);\n    const expiry = Date.now() + cacheExpiry;\n    if (cacheExpiry) {\n        cache[cacheKey] = {\n            value: value1,\n            expiry\n        };\n    }\n    return {\n        value: value1,\n        expiry\n    };\n};\nexport const getCache = (key)=>{\n    if (!cache[key]) return {};\n    return cache[key];\n};\nexport const modifyCache = (cacheKey, value)=>{\n    if (!cache[cacheKey]) return;\n    cache[cacheKey] = {\n        ...cache[cacheKey],\n        value,\n        modified: true\n    };\n};\nexport const clearCache = (keys = null)=>{\n    keys = keys ?? Object.keys(cache);\n    if (!Array.isArray(keys)) keys = [\n        keys\n    ];\n    for (const cacheKey of keys){\n        cache[cacheKey] = undefined;\n    }\n};\nexport const jsonSafeParse = (text, reviver)=>{\n    if (typeof text !== 'string') return text;\n    const firstChar = text[0];\n    if (firstChar !== '{' && firstChar !== '[' && firstChar !== '\"') return text;\n    try {\n        return JSON.parse(text, reviver);\n    } catch (e) {}\n    return text;\n};\nexport const jsonSafeStringify = (value, replacer, space)=>{\n    try {\n        return JSON.stringify(value, replacer, space);\n    } catch (e) {}\n    return value;\n};\nexport const normalizeHttpResponse = (request)=>{\n    let { response  } = request;\n    if (typeof response === 'undefined') {\n        response = {};\n    } else if (typeof response?.statusCode === 'undefined' && typeof response?.body === 'undefined' && typeof response?.headers === 'undefined') {\n        response = {\n            body: response\n        };\n    }\n    (_response = response).headers ?? (_response.headers = {});\n    request.response = response;\n    return response;\n};\nconst createErrorRegexp = /[^a-zA-Z]/g;\nexport class HttpError extends Error {\n    constructor(code, message, options = {}){\n        if (message && typeof message !== 'string') {\n            options = message;\n            message = undefined;\n        }\n        message ?? (message = httpErrorCodes[code]);\n        super(message);\n        this.cause = options.cause;\n        const name = httpErrorCodes[code].replace(createErrorRegexp, '');\n        this.name = name.substr(-5) !== 'Error' ? name + 'Error' : name;\n        this.status = this.statusCode = code;\n        this.expose = options.expose ?? code < 500;\n    }\n}\nexport const createError = (code, message, properties = {})=>{\n    return new HttpError(code, message, properties);\n};\nconst httpErrorCodes = {\n    100: 'Continue',\n    101: 'Switching Protocols',\n    102: 'Processing',\n    103: 'Early Hints',\n    200: 'OK',\n    201: 'Created',\n    202: 'Accepted',\n    203: 'Non-Authoritative Information',\n    204: 'No Content',\n    205: 'Reset Content',\n    206: 'Partial Content',\n    207: 'Multi-Status',\n    208: 'Already Reported',\n    226: 'IM Used',\n    300: 'Multiple Choices',\n    301: 'Moved Permanently',\n    302: 'Found',\n    303: 'See Other',\n    304: 'Not Modified',\n    305: 'Use Proxy',\n    306: '(Unused)',\n    307: 'Temporary Redirect',\n    308: 'Permanent Redirect',\n    400: 'Bad Request',\n    401: 'Unauthorized',\n    402: 'Payment Required',\n    403: 'Forbidden',\n    404: 'Not Found',\n    405: 'Method Not Allowed',\n    406: 'Not Acceptable',\n    407: 'Proxy Authentication Required',\n    408: 'Request Timeout',\n    409: 'Conflict',\n    410: 'Gone',\n    411: 'Length Required',\n    412: 'Precondition Failed',\n    413: 'Payload Too Large',\n    414: 'URI Too Long',\n    415: 'Unsupported Media Type',\n    416: 'Range Not Satisfiable',\n    417: 'Expectation Failed',\n    418: \"I'm a teapot\",\n    421: 'Misdirected Request',\n    422: 'Unprocessable Entity',\n    423: 'Locked',\n    424: 'Failed Dependency',\n    425: 'Unordered Collection',\n    426: 'Upgrade Required',\n    428: 'Precondition Required',\n    429: 'Too Many Requests',\n    431: 'Request Header Fields Too Large',\n    451: 'Unavailable For Legal Reasons',\n    500: 'Internal Server Error',\n    501: 'Not Implemented',\n    502: 'Bad Gateway',\n    503: 'Service Unavailable',\n    504: 'Gateway Timeout',\n    505: 'HTTP Version Not Supported',\n    506: 'Variant Also Negotiates',\n    507: 'Insufficient Storage',\n    508: 'Loop Detected',\n    509: 'Bandwidth Limit Exceeded',\n    510: 'Not Extended',\n    511: 'Network Authentication Required'\n};\n\n\n//# sourceMappingURL=index.js.map","import { normalizeHttpResponse } from '@middy/util';\nconst getOrigin = (incomingOrigin, options = {})=>{\n    if (options.origins.length > 0) {\n        if (incomingOrigin && options.origins.includes(incomingOrigin)) {\n            return incomingOrigin;\n        } else {\n            return options.origins[0];\n        }\n    } else {\n        if (incomingOrigin && options.credentials && options.origin === '*') {\n            return incomingOrigin;\n        }\n        return options.origin;\n    }\n};\nconst defaults = {\n    getOrigin,\n    credentials: undefined,\n    headers: undefined,\n    methods: undefined,\n    origin: '*',\n    origins: [],\n    exposeHeaders: undefined,\n    maxAge: undefined,\n    requestHeaders: undefined,\n    requestMethods: undefined,\n    cacheControl: undefined,\n    vary: undefined\n};\nconst httpCorsMiddleware = (opts = {})=>{\n    const options = {\n        ...defaults,\n        ...opts\n    };\n    const httpCorsMiddlewareAfter = async (request)=>{\n        normalizeHttpResponse(request);\n        const { headers  } = request.response;\n        const existingHeaders = Object.keys(headers);\n        if (existingHeaders.includes('Access-Control-Allow-Credentials')) {\n            options.credentials = headers['Access-Control-Allow-Credentials'] === 'true';\n        }\n        if (options.credentials) {\n            headers['Access-Control-Allow-Credentials'] = String(options.credentials);\n        }\n        if (options.headers && !existingHeaders.includes('Access-Control-Allow-Headers')) {\n            headers['Access-Control-Allow-Headers'] = options.headers;\n        }\n        if (options.methods && !existingHeaders.includes('Access-Control-Allow-Methods')) {\n            headers['Access-Control-Allow-Methods'] = options.methods;\n        }\n        if (!existingHeaders.includes('Access-Control-Allow-Origin')) {\n            const eventHeaders = request.event.headers ?? {};\n            const incomingOrigin = eventHeaders.Origin ?? eventHeaders.origin;\n            headers['Access-Control-Allow-Origin'] = options.getOrigin(incomingOrigin, options);\n        }\n        let vary = options.vary;\n        if (headers['Access-Control-Allow-Origin'] !== '*' && !vary) {\n            vary = 'Origin';\n        }\n        if (vary && !existingHeaders.includes('Vary')) {\n            headers.Vary = vary;\n        }\n        if (options.exposeHeaders && !existingHeaders.includes('Access-Control-Expose-Headers')) {\n            headers['Access-Control-Expose-Headers'] = options.exposeHeaders;\n        }\n        if (options.maxAge && !existingHeaders.includes('Access-Control-Max-Age')) {\n            headers['Access-Control-Max-Age'] = String(options.maxAge);\n        }\n        if (options.requestHeaders && !existingHeaders.includes('Access-Control-Request-Headers')) {\n            headers['Access-Control-Request-Headers'] = options.requestHeaders;\n        }\n        if (options.requestMethods && !existingHeaders.includes('Access-Control-Request-Methods')) {\n            headers['Access-Control-Request-Methods'] = options.requestMethods;\n        }\n        const httpMethod = getVersionHttpMethod[request.event.version ?? '1.0']?.(request.event);\n        if (!httpMethod) {\n            throw new Error('[http-cors] Unknown http event format');\n        }\n        if (httpMethod === 'OPTIONS' && options.cacheControl && !existingHeaders.includes('Cache-Control')) {\n            headers['Cache-Control'] = options.cacheControl;\n        }\n        request.response.headers = headers;\n    };\n    const httpCorsMiddlewareOnError = async (request)=>{\n        if (request.response === undefined) return;\n        return httpCorsMiddlewareAfter(request);\n    };\n    return {\n        after: httpCorsMiddlewareAfter,\n        onError: httpCorsMiddlewareOnError\n    };\n};\nconst getVersionHttpMethod = {\n    '1.0': (event)=>event.httpMethod,\n    '2.0': (event)=>event.requestContext.http.method\n};\nexport default httpCorsMiddleware;\n\n\n//# sourceMappingURL=index.js.map","import middy from '@middy/core';\nimport cors from '@middy/http-cors';\nimport middyJsonBodyParser from '@middy/http-json-body-parser';\n\nexport const middyfy = (handler) => {\n  return middy(handler)\n    .use(cors())\n    .use(middyJsonBodyParser())\n}\n","import products from '../mocks/products.json';\nimport { Product } from '@types/product';\nclass ProductProvider {\n  constructor() {\n  }\n  async getAllProducts (): Promise<Product[]> {\n    const productList = await products;\n    if (!productList) {\n      throw new Error('ProductList not found');\n    }\n    return productList;\n  }\n  async getProductById (id: string): Promise<Product> {\n    const product = products.find(\n      (item) => item.id === id\n    );\n    if (!product) {\n      throw new Error('Product not found');\n    }\n    return product;\n  }\n}\n\nexport const productProvider = new ProductProvider();\n","import type { ValidatedEventAPIGatewayProxyEvent } from '@libs/api-gateway';\nimport { formatJSONResponse } from '@libs/api-gateway';\nimport { middyfy } from '@libs/lambda';\nimport { productProvider } from '@providers/ProductProvider';\n\nconst getProductList: ValidatedEventAPIGatewayProxyEvent<never> = async () => {\n  try {\n    const products = await productProvider.getAllProducts();\n    return formatJSONResponse(products);\n  } catch (err) {\n    console.log(err);\n    return formatJSONResponse({ error: err.message }, 500);\n  }\n};\n\nexport const main = middyfy(getProductList);\n"],"names":["module","exports","require","runRequest","async","request","beforeMiddlewares","baseHandler","afterMiddlewares","onErrorMiddlewares","plugin","_plugin$beforeHandler","_plugin$afterHandler","runMiddlewares","undefined","response","beforeHandler","call","event","context","afterHandler","e","error","originalError","_plugin$requestEnd","requestEnd","middlewares","nextMiddleware","_plugin$beforeMiddlew","_plugin$afterMiddlewa","beforeMiddleware","name","res","afterMiddleware","_plugin$beforePrefetc","beforePrefetch","instance","_plugin$requestStart","requestStart","internal","use","Array","isArray","middleware","applyMiddleware","before","after","onError","Error","push","unshift","onErrorMiddleware","__middlewares","mimePattern","defaults","reviver","opts","options","_headers$ContentType","headers","body","contentTypeHeader","test","data","isBase64Encoded","Buffer","from","toString","rawBody","JSON","parse","err","createError","Agent","awsClientDefaultOptions","httpOptions","agent","secureProtocol","createPrefetchClient","awsClientOptions","client","AwsClient","awsClientCapture","getInternal","variables","keys","values","Object","promises","internalKey","_valuePromise","pathOptionKey","split","rootOptionKey","shift","valuePromise","then","Promise","resolve","value","reduce","p","c","allSettled","errors","filter","status","map","reason","message","length","stringify","obj","key","index","sanitizeKey","sanitizeKeyPrefixLeadingNumber","sanitizeKeyRemoveDisallowedChar","replace","cache","getCache","statuses","inherits","createErrorRegexp","createClient","awsClientCredentials","awsClientAssumeRole","credentials","canPrefetch","disablePrefetch","processCache","fetch","cacheExpiry","cacheKey","cached","unexpired","expiry","Date","now","modified","modifyCache","clearCache","_keys","jsonSafeParse","string","firstChar","normalizeHttpResponse","_response$headers","_response","code","properties","className","substr","HttpError","msg","captureStackTrace","setPrototypeOf","prototype","defineProperty","enumerable","configurable","writable","desc","getOwnPropertyDescriptor","assign","statusCode","expose","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","a","definition","o","get","prop","hasOwnProperty","r","Symbol","toStringTag","formatJSONResponse","keepAlive","constructor","httpErrorCodes","super","this","cause","getOrigin","incomingOrigin","origins","includes","origin","methods","exposeHeaders","maxAge","requestHeaders","requestMethods","cacheControl","vary","getVersionHttpMethod","httpMethod","requestContext","http","method","httpCorsMiddlewareAfter","existingHeaders","String","eventHeaders","Origin","Vary","version","productProvider","ProductProvider","productList","id","product","item","main","handler","products","getAllProducts","console","log"],"sourceRoot":""}